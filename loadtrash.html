<!DOCTYPE html>
<html>
	
	<head>
		<meta charset="UTF-8">
		<title>Sprite</title>
	</head>
	
	<body>
		<div style = "text-align:center;">
			<canvas id="myCanvas" width="1500" height="666" style="border:solid 3px purple">
				Your browser does not support HTML5 Canvas.
			</canvas>
		</div>
	<script>
		const canvas = document.querySelector('#myCanvas');
		const ctx = canvas.getContext("2d");
		
		const W = canvas.width, H = canvas.height;

		let loaded = false;
		
		var image = new Image();
		image.src = 'images/kitty.png';
		
		//sprite frame counter 		
		let frameCol = 0;
		let frameRow = 0;
		
		let x = canvas.width / 2.13;
		let y = canvas.height / 2.13;
		let sizex = 192/4;
		let sizey = 192/4;
		
		let rightKey = false; //only for Canvas#2
		let leftKey = false;
		let upKey = false;
		let downKey = false;
		let gKey = false;
		let pKey = false
		
		
		
		//handler for keydown
		function ArrowPressed(e) {
			e.preventDefault();
			if (e.key == 'ArrowRight') {
				rightKey = true; //Canvas#2
			}
			else if (e.key == 'ArrowLeft'){
				leftKey = true; //Canvas#
			}
			else if (e.key == 'ArrowUp') {
				upKey = true; //Canvas#2
			}
			else if (e.key == 'ArrowDown'){
				downKey = true; //Canvas#
			}
			else if(e.keyCode==71){
				gKey = true;
			}
			else if(e.keyCode==80){
				
				sizex = 96/2
				sizey = 576/12
				if (!pKey)
					image.src = 'images/actions.png'
				pKey = true;

			}
		}

		//handler for keyup
		function ArrowReleased(e) {
			if (e.key == 'ArrowRight'){
				rightKey = false;
				frameCol = 0;
			}
			else if (e.key == 'ArrowLeft'){
				leftKey = false;
				frameCol = 0;
			}
			else if (e.key == 'ArrowUp'){
				upKey = false;
				frameCol = 0;
			}
			else if (e.key == 'ArrowDown'){
				downKey = false;
				frameCol = 0;
			}
			else if (e.keyCode == 71){
				gKey = false;
				frameCol = 0;
			}
		}
		
		//sets handlers for events keydown & keyup
		window.addEventListener('keydown', ArrowPressed);
		window.addEventListener('keyup', ArrowReleased);


		class Trash{
			src = '';
			x = 0;
			y = 0;

			constructor(x, y) {    // CONSTRUCTOR
                this.x = x; // initial X position
                this.y = y; // initial Y position
                // (constant) horizontal displacement (velocity): d is a direction angle
                this.dX = 2 * Math.cos(d);
                // (constant) vertical displacement (velocity): d is a direction angle
                this.dY = 2 * Math.sin(d);
                this.c = c; // color
                this.R = r; // circle radius (constant)
            }
		}

		function init(){

		}
		
		function render() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			if (rightKey && x < canvas.width - 50){
				x+=10;
				frameRow = 3;
				frameCol++;	
				if (frameCol == 4)
				frameCol = 0;
			}
			else if (leftKey && x > 10){
				x-=10;
				frameRow = 2;
				frameCol++;	
				if (frameCol == 4)
				frameCol = 0;
			}
			else if (upKey && y > 10){
				y-=10;
				frameRow = 1;
				frameCol++;	
				if (frameCol == 4)
				frameCol = 0;
			}
			else if (downKey && y < canvas.height - 50){
				y+=10;
				frameRow = 0;
				frameCol++;	
				if (frameCol == 4)
				frameCol = 0;
			}
			else if (gKey){
				frameCol++;	
				if (frameCol == 2)
					frameCol = 0;
				}
				else if (pKey){
					if (frameRow < 8){
						frameRow += 8
						frameCol = 2
					}
					frameCol--;	
					if (frameCol == -1){
						pKey = false;
						image.src = 'images/kitty.png'
						frameCol = 0;
						sizex = 192/4
						sizey = 192/4
						frameRow -= 8
					}
					
				}
				ctx.drawImage(image, frameCol * sizex, frameRow * sizey, sizex, sizey, x, y, 192/2,192/2);
				loadImage(menu)
				
			}			
			
			
			window.onload = function () {
				loaded = true
				setInterval(render, 1000 / 10);
			};

            let trashList = []

			function renderTrash(){
				
			}

			
			// function main() {
			// 	let a = Math.random()*(canvas.width-50)
			// 	let b = Math.random()*(canvas.height-100)
			// 		ctx.drawImage(menu, a, b);
			// 	}
			
			// var item = new Image();
			// item.src = 'trash/rubber_duck.png'
			// var menu = loadImage('trash/mustard.png', main);
			// function loadImage(src, onload) {
			// 	var img = new Image();
			// 	img.onload = onload;
			// 	img.src = src;
			// 	return img;
			// }



			window.onload = () => {
            init();
            render();  //start the animation
        };

        let b = new Array(); // balls array of objects

        //CLASS
        class Ball {
            constructor(x, y, r, d, c) {    // CONSTRUCTOR
                this.x = x; // initial X position
                this.y = y; // initial Y position
                // (constant) horizontal displacement (velocity): d is a direction angle
                this.dX = 2 * Math.cos(d);
                // (constant) vertical displacement (velocity): d is a direction angle
                this.dY = 2 * Math.sin(d);
                this.c = c; // color
                this.R = r; // circle radius (constant)
            }

            draw() {
                ctx.fillStyle = this.c;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.R, 0, 2 * Math.PI);
                ctx.fill();
            }
            update() {
                // check Canvas vertical collisions
                if (this.x < this.R || this.x > W - this.R)
                    this.dX = -this.dX;
                // check Canvas horizontal collisions
                if (this.y < this.R || this.y > H - this.R)
                    this.dY = -this.dY;
                this.x += this.dX;  // update horizontal position
                this.y += this.dY;  // update vertical position
            }
        }

        function init() {
            //setup 50 balls
            for (let i = 0; i < 50; i++) {
                let R = Math.floor(Math.random() * 256);
                let G = Math.floor(Math.random() * 256);
                let B = Math.floor(Math.random() * 256);
                let color = `rgb(${R},${G},${B})`; // random color

                // random position (inside Canvas)
                let xInit = 10 + Math.random() * (W - 2 * 10);
                let yInit = 10 + Math.random() * (H - 2 * 10);

                // random direction
                let direction = Math.random() * 2 * Math.PI;

                // push new object into array
                b.push(new Ball(xInit, yInit, 10, direction, color))
            }
        }


        function render() {
            // fade Canvas
            ctx.fillStyle = "rgba(255,255,255,0.25)"
            ctx.fillRect(0, 0, W, H);

            // draw & update all objects
            b.forEach(ball => {
                ball.draw();
                ball.update();
            });

            //new frame
            window.requestAnimationFrame(render);
        }

	</script>
</body>

</html>